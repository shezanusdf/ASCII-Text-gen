from flask import Flask, render_template, request, redirect, url_for

app = Flask(__name__)

BITMAP_TEMPLATES = {
    "world": '''....................................................................
   **************   *  *** **  *      ******************************
  ********************* ** ** *  * ****************************** *
 **      *****************       ******************************
          *************          **  * **** ** ************** *
           *********            *******   **************** * *
            ********           ***************************  *
   *        * **** ***         *************** ******  ** *
               ****  *         ***************   *** ***  *
                 ******         *************    **   **  *
                 ********        *************    *  ** ***
                   ********         ********          * *** ****
                   *********         ******  *        **** ** * **
                   *********         ****** * *           *** *   *
                     ******          ***** **             *****   *
                     *****            **** *            ********
                    *****             ****              *********
                    ****              **                 *******   *
                    ***                                       *    *
                    **     *                    *
....................................................................''',

    "Smiley": '''
................................................................................
                     *******************************                            
                  *************************************                         
               ***********                     ***********                      
            *********                               *********                   
          *******                                       *******                 
        *****                                             *****                
       ****             ******              ******          ****               
      ***             **********          **********         ***              
     ***             ************        ************         ***             
    ***             **************      **************        ***             
   ***              **************      **************         ***            
   **               **************      **************          **            
  ***               **************      **************          ***           
  **                  **********          **********             **           
  **                    ******              ******               **           
  **                                                              **           
  **           ***************************************           **           
  ***        ***************************************             ***          
   ***     ***************************************              ***           
    ***                                                         ***           
     ***        ****                         ****              ***            
      ***        ****                       ****              ***             
       ****        ****                   ****              ****              
        *****        ***********************              *****               
          *******                                       *******                
            *********                               *********                  
               ***********                     ***********                     
                  *************************************                        
                     *******************************                            
................................................................................
''',

"Heart": '''
         ******       ******
       **********   **********
      ************ ************
     **************************
     **************************
      ************************
       **********************
        ********************
         ******************
          ****************
           **************
            ************
             **********
              ********
               ******
                ****
                 **
''',

     "Sad": '''
................................................................................
                     *******************************                            
                  *************************************                         
               ***********                     ***********                      
            *********                               *********                   
          *******                                       *******                 
        *****                                             *****                
       ****             ******              ******          ****               
      ***             **********          **********         ***              
     ***             ************        ************         ***             
    ***             **************      **************        ***             
   ***              **************      **************         ***            
   **               **************      **************          **            
  ***               **************      **************          ***           
  **                  **********          **********             **           
  **                    ******              ******               **           
  **                                                              **           
  **           ***************************************           **           
  ***        ***************************************             ***          
   ***     ***************************************               ***           
    ***                                                          ***           
     ***                ***********************                  ***            
      ***            ****                     ****              ***             
       ****        ****                          ****         ****              
        *****                                              *****            
          *******                                       *******                
            *********                               *********                  
               ***********                     ***********                     
                  *************************************                        
                     *******************************                            
................................................................................
''',

    "Lightning": '''
            **********
           ***********
          ************
         *************
        **************
           ***********
          ************
         *************
        **************
       ***************
      ****************
     ****************
            *********
           **********
          ***********
         ************
        *************
       **************
      ***************
     ****************
    *****************
       ************
      *************
     **************
    ***************
      ***********
     ************
    *************
''',

    "Butterfly": '''
    ****              ****
   ******            ******
  ********          ********
 **********        **********
************      ************
 ***********      ***********
  **********      **********
    ********      ********
      *****        *****
       ****        ****
        ***   **   ***
         **  ****  **
          ** **** **
           ********
           ********
          **********
         ************
        **************
       ****************
      ******************
       ****************
        **************
         ************
          **********
           ********
''',

    "Rocket": '''
             ****
            ******
           ********
          **********
         ************
        **************
       ****************
      ******************
        **************
        **************
        **************
        **************
        **************
        **************
        **************
        **************
        **************
       ****************
      ******************
      ******************
       ***    ***    ***
       ***    ***    ***
      ****    ***    ****
     *****    ***    *****
    ******    ***    ******
   *******    ***    *******
    ******           ******
     *****           *****
''',

    "Peace": '''
              *****************
          *************************
        *****************************
       *******************************
      *********************************
     ***********************************
    *************************************
    *************************************
   ***************************************
   ***************************************
  ****************************************
  *****************   ********************
  ***************       ******************
  **************         *****************
  *************           ****************
  ************             ***************
  ***********               **************
  **********                 *************
  ***********               **************
  ************             ***************
  *************           ****************
  **************         *****************
  ***************       ******************
  *****************   ********************
   ***************************************
   ***************************************
    *************************************
    *************************************
     ***********************************
      *********************************
       *******************************
        *****************************
          *************************
              *****************
''',

    "Diamond": '''
                ***
               *****
              *******
             *********
            ***********
           *************
          ***************
         *****************
        *******************
       *********************
      ***********************
     *************************
    ***************************
   *****************************
  *******************************
 *********************************
***********************************
 *********************************
  *******************************
   *****************************
    ***************************
     *************************
      ***********************
       *********************
        *******************
         *****************
          ***************
           *************
            ***********
             *********
              *******
               *****
                ***
''',

    "Dog": '''
    ****                      ****
   ******                    ******
  ********                  ********
  *********                *********
  **********              **********
   ***********************************
   ***********************************
  *************************************
  *****   *******************   *****
  ****  ***********************  ****
  ****  ***********************  ****
  *****   *******************   *****
  *************************************
  *************************************
  *************************************
   ***********************************
    ************   *** ***************
    ***********     *     ************
     **********     *     ***********
      *********     *     **********
       ********     *     *********
        *********       *********
          **********************
            ******************
              **************
''',

    "Music": '''
                          ****
                         *****
                        ******
                       *******
                      ********
                     ********
                    ********
                   ********
                  ********
                 ********
                ********
               ********
              ********
             ********
            ********
           ********
          ********
         ********
        ********
       ********
      ********         *********
     ********        *************
    ********        ***************
   ********        *****************
  ********        *******************
  *******        *********************
   ******       *********************
    *****       *******************
     *****       *****************
      ******      ***************
        ********   ***********
          ********************
            ****************
''',
}

def render_bitmap(bitmap: str, message:str) -> str:
    output = ''
    bitnum = 0
    
    for line in bitmap.splitlines():
        for bit in line:
            if bit == ' ':
                output += ' '
            else :
                bitnum += 1
                if bitnum % len(message) == 0:
                    bitnum = 0
                output += message[bitnum - 1]
        output += '\n'
        
    return output

@app.route("/", methods=["GET", "POST"])
def home():
    rendered = ""
    selected = "world"

    if request.method == "POST":
        message = request.form.get("message")
        selected = request.form.get("template") or "world"

        if message and selected in BITMAP_TEMPLATES:
            bitmap = BITMAP_TEMPLATES[selected]
            rendered = render_bitmap(bitmap, message)

    return render_template(
        "index.html",
        templates=BITMAP_TEMPLATES.keys(),
        rendered=rendered,
        selected=selected
    )

        
if __name__ == "__main__":
    app.run(debug = True)